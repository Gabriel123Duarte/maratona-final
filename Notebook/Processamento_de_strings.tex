\chapter{Processamento de Strings}

\section{Aho-Corasick}

Após inserir todas as strings, chamar a função $aho();$

\begin{multicols}{2}
	\begin{lstlisting}

#define MAXN 100100
#define ALPHA 15

int trie[MAXN][ALPHA];
int term[MAXN];
int failure[MAXN];
int cnt;
void insert(string s){
	int node = 0;
	for(auto c : s){
		if(!trie[node][c-'a'])
		trie[node][c-'a'] = cnt++;
		node = trie[node][c-'a'];
	}
	term[node] = 1;
}

void aho(){
	queue<int> q;
	
	for(int i = 0; i < ALPHA; i++){
		if(trie[0][i]){
			failure[trie[0][i]] = 0;
			q.push(trie[0][i]);
		}
	}
	
	while(!q.empty()){
		int u = q.front(); q.pop();
		for(int i = 0; i < ALPHA; i++){
			if(trie[u][i]){
				int v = failure[u];
				while(v && !trie[v][i])
				v = failure[v];
				v = trie[v][i];
				failure[trie[u][i]] = v;
				term[trie[u][i]] |= term[v];
				q.push(trie[u][i]);
			}	
		}
	}
}

int next(int node, int c){
	while(node && !trie[node][c])
	node = failure[node];
	return trie[node][c];
}

void init(){
	memset(trie, 0, sizeof trie);
	memset(term, 0, sizeof term);
	memset(failure, 0, sizeof failure);
	memset(vis, 0, sizeof vis);
	cnt = 1;
}


\end{lstlisting}
\end{multicols}

\section{Rabin-Karp}

String matching $O(|S| + |T|)$.

\begin{multicols}{2}
	\begin{lstlisting}


string s, t; // input
const int p = 31;
vector<ull> p_pow(max(s.size(), t.size()));
p_pow[0] = 1;
for(int i = 1; i < p_pow.size(); i++)
	p_pow[i] = p_pow[i-1]*p;
	
vector<ull> h(t.size());
for(int i = 0; i < t.size(); i++){
	h[i] = (t[i]-'a'+1) * p_pow[i];
	if(i)
		h[i] += h[i-1];
}

ull h_s = 0;
for(int i = 0; i < s.size(); i++)
	h_s += (s[i]-'a'+1) * p_pow[i];

for(int i = 0; i + s.size()-1 < t.size(); i++){
	ull cur_h = h[i+s.size()-1];
	if(i)
		cur_h -= h[i-1];	
	if(cur_h == h_s * p_pow[i])
		cout << i << " ";
}
\end{lstlisting}
\end{multicols}
\section{Repetend: menor período de uma string}

Menor período de uma string em $O(n)$.

\begin{multicols}{2}
	\begin{lstlisting}

#define MAXN 100010

int repetend(string s){
	int n = s.size();
	int nxt[n+1];
	nxt[0] = -1;
	for(int i = 1; i <= n; i++){
		int j = nxt[i-1];
		while(j>=0 && s[j] != s[i-1])
			j = nxt[j];
		nxt[i] = j+1;
	}
	int a = n-nxt[n];
	if(n%a==0)
		return a;
	return n;	
}

\end{lstlisting}
\end{multicols}

